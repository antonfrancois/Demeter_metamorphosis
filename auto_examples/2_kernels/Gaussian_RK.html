

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A Gaussian Reproducing Kernel &mdash; Demeter_metamorphosis 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]]}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A multiscale Gaussian Reproducing Kernel" href="multi_scale_gaussianRKHS.html" />
    <link rel="prev" title="Kernel examples" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Demeter_metamorphosis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Gallery of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#registration-examples">Registration examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#kernel-examples">Kernel examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#utility-functions-examples">Utility functions examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1_registration/index.html">Registration examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Kernel examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">A Gaussian Reproducing Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi_scale_gaussianRKHS.html">A multiscale Gaussian Reproducing Kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../3_utils/index.html">Utility functions examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Demeter documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_users.html">For advanced users</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Demeter_metamorphosis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Gallery of examples</a></li>
          <li class="breadcrumb-item"><a href="index.html">Kernel examples</a></li>
      <li class="breadcrumb-item active">A Gaussian Reproducing Kernel</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/2_kernels/Gaussian_RK.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-2-kernels-gaussian-rk-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="a-gaussian-reproducing-kernel">
<span id="gaussianrk"></span><span id="sphx-glr-auto-examples-2-kernels-gaussian-rk-py"></span><h1>A Gaussian Reproducing Kernel<a class="headerlink" href="#a-gaussian-reproducing-kernel" title="Link to this heading"></a></h1>
<p>This page is not only meant to show you how to use the Gaussian Reproducing Kernel (GRK) but also,
to provide you with everything you need to know about kernel operators in the
Demeter library: how they are used and the available options. If you are familiar with reproducing
kernels on point cloud data, you might be surprised. Since we are working with
images, it is as if we had a point cloud where each pixel is a Dirac with its weight
being the pixel intensity. As a result, there is a large number of closely spaced points.</p>
<blockquote>
<div><p>This is why, instead of using a classical kernel that computes the distance between</p>
</div></blockquote>
<p>points, we perform the same operation using a convolution.</p>
<p>In metamorphosis, the RK is used to parameterize the space of acceptable vector fields <span class="math notranslate nohighlight">\(V\)</span>
through its norm, and is used to compute the vector field from the momentum.</p>
<div class="math notranslate nohighlight">
\[v = - K_{\sigma} ( p \nabla I)\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is the momentum, <span class="math notranslate nohighlight">\(I\)</span> the image and <span class="math notranslate nohighlight">\(K_{\sigma}\)</span> the Gaussian RK operator.
we also call <span class="math notranslate nohighlight">\(p \nabla I\)</span> the field momentum.</p>
<p>Importing the necessary libraries</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">demeter.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">DLT_KW_IMAGE</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">demeter.utils.reproducing_kernels</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">demeter.utils.torchbox</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tb</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">demeter.utils.bspline</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bs</span>
<span class="kn">import</span><span class="w">  </span><span class="nn">demeter.metamorphosis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mt</span>
</pre></div>
</div>
<p>To use the Gaussian RK, we need to choose a sigma. The larger the sigma, the more the RK will
smooth the vector fields. The smaller the sigma, the more the RK will keep the high frequency
information of the vector fields. We choose sigmas in pixel units, meaning that the gaussian
will reach a value of 0.01 at about a distance of 3 sigma pixels from the center.
We define the sigma as a tuple <span class="math notranslate nohighlight">\((\sigma_x,\sigma_y)\)</span> (or <span class="math notranslate nohighlight">\((\sigma_x,\sigma_y,\sigma_y)\)</span> in 3d)
to allow for anisotropic smoothing and to give  the dimensions of the image.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kernelOp</span> <span class="o">=</span> <span class="n">rk</span><span class="o">.</span><span class="n">GaussianRKHS</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kernelOp</span><span class="p">)</span>
<span class="n">kernelOp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gaussian_RK_001.png" srcset="../../_images/sphx_glr_Gaussian_RK_001.png" alt="kernel sigma: 2, Gaussian Kernel $\sigma$=(4, 2), kernel sigma: 4" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>GaussianRKHS,2D
        filter :fft_filter, sigma :(4, 2)
        kernel_size :(1, 49, 25)
        kernel_reach :6
        normalized :True
</pre></div>
</div>
<p>In the cell above, we initialized a Gaussian RK operator with sigma = (10,5). You can
print the operator to see its parameters. You can see the kernel size and its reach.
The kernel size is the size of the kernel in pixel units. The reach is the distance
at which we want to truncate the kernel. A reach of 3 means will be truncated at 3 sigma
from center to edge.</p>
<p>This operator in meant to smooth the vector field momentum in the Metamorphosis
geodesic equation. Before, to use it in a Metamorphosis registration, let’s
visualize its effect on a synthetic vector field.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a synthetic vector field</span>
<span class="n">H</span><span class="p">,</span><span class="n">W</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span><span class="mi">30</span>
<span class="n">s</span>  <span class="o">=</span> <span class="mf">.5</span>
<span class="c1"># Random control matrix</span>
<span class="n">cms</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">H</span><span class="o">*</span><span class="n">s</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">*</span><span class="n">s</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">cms</span> <span class="o">*=</span> <span class="mi">5</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">field2D_bspline</span><span class="p">(</span><span class="n">cms</span><span class="p">,</span> <span class="n">n_pts</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">W</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim_stack</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="kc">None</span><span class="p">]</span>
<span class="n">smoothed_field</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">im2grid</span><span class="p">(</span><span class="n">kernelOp</span><span class="p">(</span> <span class="n">tb</span><span class="o">.</span><span class="n">grid2im</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="p">))</span>
<span class="n">ic</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">smoothed_field</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tb</span><span class="o">.</span><span class="n">quiver_plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original field&#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">check_diffeo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tb</span><span class="o">.</span><span class="n">quiver_plot</span><span class="p">(</span><span class="n">smoothed_field</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Smoothed field&#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">check_diffeo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gaussian_RK_002.png" srcset="../../_images/sphx_glr_Gaussian_RK_002.png" alt="Gaussian RK" class = "sphx-glr-single-img"/><blockquote>
<div><p>a tensor of shape (1,H,W,2) where H and W are the height and width of the image.
You might find it strange that we pass the field in image representation to the
kernel operator. This mostly for efficiency reasons, see <cite>pytorch stride &lt;https://discuss.pytorch.org/t/pytorch-tensor-stride-how-it-works/90537&gt;</cite>
for more information.</p>
<p>In the plot above, we can see the effect of the Gaussian RK on a synthetic vector field.
We show the “diffeomorphismness” of the field by plotting the sign of the Jacobian of the field.
Green means that the Jacobian is positive, red means that the Jacobian is negative, and the image
must be all green for the deformation to be a diffeomorphism. We can see that the smoothed field
is a diffemorphism !</p>
<p>Good, now lets try on a real use case. First let’s load a source and image target:
Try to change the size and the proposed sigma to see their effects on the
registration results.  Feel free to try different values that the one proposed.</p>
</div></blockquote>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda:0&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;device used :&#39;</span><span class="p">,</span><span class="n">device</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="c1"># size = (300,150)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">reg_open</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">reg_open</span><span class="p">(</span><span class="s1">&#39;star_sr5_r10&#39;</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="o">**</span><span class="n">DLT_KW_IMAGE</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="o">**</span><span class="n">DLT_KW_IMAGE</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">imCmp</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="s1">&#39;compose&#39;</span><span class="p">),</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;superposition of source and target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gaussian_RK_003.png" srcset="../../_images/sphx_glr_Gaussian_RK_003.png" alt="source, target, superposition of source and target" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>device used : cpu
</pre></div>
</div>
<p>Now let’s try to register the source to the target using LDDMM with differents
sigma values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># sigma = (10,5)      # wonky result</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>     <span class="c1"># good result</span>
<span class="c1"># sigma = (20,20)     # cannot get details.</span>


<span class="n">kernelOp</span> <span class="o">=</span> <span class="n">rk</span><span class="o">.</span><span class="n">GaussianRKHS</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kernelOp</span><span class="p">)</span>
<span class="n">mr</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">lddmm</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">kernelOperator</span> <span class="o">=</span> <span class="n">kernelOp</span><span class="p">,</span>
                        <span class="n">n_iter</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="n">cost_cst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">grad_coef</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">integration_steps</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                        <span class="n">dx_convention</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span>
                        <span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>GaussianRKHS,2D
        filter :fft_filter, sigma :(10, 10)
        kernel_size :(1, 121, 121)
        kernel_reach :6
        normalized :True

Progress: [##--------]  20.00%  (Ssd : ,655.1315).
Progress: [###-------]  30.00%  (Ssd : ,285.0678).
Progress: [####------]  40.00%  (Ssd : ,157.9997).
Progress: [#####-----]  50.00%  (Ssd : ,126.9168).
Progress: [######----]  60.00%  (Ssd : ,121.4015).
Progress: [#######---]  70.00%  (Ssd : ,117.6779).
Progress: [########--]  80.00%  (Ssd : ,115.2220).
Progress: [#########-]  90.00%  (Ssd : ,104.2477).
Progress: [##########] 100.00% Done...
 (Ssd : , 97.9167).
Computation of forward done in  0:00:30s and 0.844cents  s

Computation of lddmm done in  0:00:30s and 0.844cents  s
</pre></div>
</div>
<p>Integration and convergence plot. Then we compare the source, target
and registered source images</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mr</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_Gaussian_RK_004.png" srcset="../../_images/sphx_glr_Gaussian_RK_004.png" alt="Lambda = 1 rho = 1.0" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_Gaussian_RK_005.png" srcset="../../_images/sphx_glr_Gaussian_RK_005.png" alt="source, target, Integrated source image, comparaison deformed image with target" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>((&lt;Figure size 1000x500 with 2 Axes&gt;, array([&lt;Axes: title={&#39;center&#39;: &#39;Lambda = 1 rho = 1.0&#39;}&gt;, &lt;Axes: &gt;],
      dtype=object)), (&lt;Figure size 2000x2000 with 4 Axes&gt;, array([[&lt;Axes: title={&#39;center&#39;: &#39;source&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;target&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Integrated source image&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;comparaison deformed image with target&#39;}&gt;]],
      dtype=object)))
</pre></div>
</div>
<p>This plot shows the deformation as a grid and arrows. along with the
deformed image.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mr</span><span class="o">.</span><span class="n">plot_deform</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gaussian_RK_006.png" srcset="../../_images/sphx_glr_Gaussian_RK_006.png" alt="diffeo = tensor(True)" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 33.124 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-2-kernels-gaussian-rk-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/20162e0384388e4d6fd9a65ecd01c683/Gaussian_RK.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Gaussian_RK.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5b38d46e32f4cf8f36ee2fe9c2ab2c2d/Gaussian_RK.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Gaussian_RK.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b5fe23812db2868f5f81066eb623e811/Gaussian_RK.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">Gaussian_RK.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Kernel examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="multi_scale_gaussianRKHS.html" class="btn btn-neutral float-right" title="A multiscale Gaussian Reproducing Kernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Anton François.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>