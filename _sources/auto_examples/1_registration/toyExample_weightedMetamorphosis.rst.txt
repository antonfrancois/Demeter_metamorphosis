
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/1_registration/toyExample_weightedMetamorphosis.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_1_registration_toyExample_weightedMetamorphosis.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_1_registration_toyExample_weightedMetamorphosis.py:


.. _toyExample_grayScott_weightedMetamorphosis:

This toy example was build to simulate a cancer growth in a brain.
This is a simple example of how to use the weighted metamorphosis to register two images.
.

.. GENERATED FROM PYTHON SOURCE LINES 9-10

Import the necessary packages

.. GENERATED FROM PYTHON SOURCE LINES 10-40

.. code-block:: Python

    import matplotlib.pyplot as plt


    try:
        import sys, os
        # add the parent directory to the path
        base_path  = os.path.join(os.path.dirname(os.path.abspath(__file__)),'..')
        sys.path.insert(0,base_path)
        import __init__

    except NameError:
        pass



    from demeter.constants import *
    import torch
    import kornia.filters as flt
    # %reload_ext autoreload
    # %autoreload 2
    import demeter.utils.reproducing_kernels as rk
    import demeter.metamorphosis as mt
    import demeter.utils.torchbox as tb

    device = 'cpu'
    if torch.cuda.is_available():
        device = 'cuda:0'
    print(f"Used device: {device}")






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Used device: cpu




.. GENERATED FROM PYTHON SOURCE LINES 41-42

Load the images

.. GENERATED FROM PYTHON SOURCE LINES 42-77

.. code-block:: Python


    size = (300,300)
    source_name,target_name = '23','24'
    S = tb.reg_open(source_name,size = size).to(device)   # Small oval with gray dots
    T = tb.reg_open(target_name,size = size).to(device)   # Big circle with deformed gray dots
    seg = tb.reg_open('21_seg',size=size).to(device)      # rounded triangle

    ## Construct the target image
    ini_ball,_ = tb.make_ball_at_shape_center(seg,overlap_threshold=.1,verbose=True)
    ini_ball = ini_ball.to(device)
    T[seg>0] = 0.5                                       # Add the rounded triangle to the target

    source = S
    target = T
    # mask = mr.mp.image_stock

    source_name = 'oval_w_round'
    target_name = 'round_w_triangle_p_rd'

    kw_img = dict(cmap='gray',vmin=0,vmax=1)
    plt.rcParams["figure.figsize"] = (20,20)
    fig,ax = plt.subplots(2,2)
    ax[0,0].imshow(source[0,0,:,:].cpu().numpy(),**kw_img)
    ax[0,0].set_title('source')
    ax[0,1].imshow(target[0,0,:,:].cpu().numpy(),**kw_img)
    ax[0,1].set_title('target')
    ax[1,0].imshow(tb.imCmp(source,target),vmin=0,vmax=1)
    ax[1,1].imshow(seg[0,0].cpu().numpy(),**kw_img)
    ax[1,1].set_title('segmentation')
    # plt.show()








.. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_001.png
   :alt: source, target, segmentation
   :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    centre = (tensor(145), tensor(150)), r = 9 and the seg and ball have 249 pixels overlapping

    Text(0.5, 1.0, 'segmentation')



.. GENERATED FROM PYTHON SOURCE LINES 78-79

Define the kernel operator

.. GENERATED FROM PYTHON SOURCE LINES 79-85

.. code-block:: Python


    sigma= [(5,5),(15,15)]
    kernelOp = rk.Multi_scale_GaussianRKHS(sigma, normalized = False)
    kernelOp.plot()
    rk.plot_kernel_on_image(kernelOp,image = target.cpu())
    print("sigma",sigma)



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_002.png
         :alt: kernel sigma: (15, 15), Gaussian Kernel $\sigma$=[(5, 5), (15, 15)], kernel sigma: (5, 5)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_003.png
         :alt: sigma = [(5, 5), (15, 15)], subdiv = None
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    sigma is not a float, I suspect that the kernel is not purly gaussian.
    /home/runner/work/Demeter_metamorphosis/Demeter_metamorphosis/src/demeter/utils/reproducing_kernels.py:302: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
      ax.legend()
    sigma is not a float, I suspect that the kernel is not purly gaussian.
    kernel shape: torch.Size([1, 91, 91])
    kernel shape: 91 91
    x, y torch.Size([91, 91]) torch.Size([91, 91])
    sigma [(5, 5), (15, 15)]




.. GENERATED FROM PYTHON SOURCE LINES 86-88

####################################################################
  Classic metamorphosis

.. GENERATED FROM PYTHON SOURCE LINES 88-108

.. code-block:: Python


    rho = 0.7
    momentum_ini =0
    mr = mt.metamorphosis(source,target,momentum_ini,
        kernelOperator=kernelOp,
        rho=rho,
        integration_steps=10,
        cost_cst=1e-2,
        n_iter=20,
        grad_coef=1,
         dx_convention='pixel',
    )
    mr.plot()
    mr.plot_deform()
    mr.mp.plot()
    plt.show()
    mr.save_to_gif("image deformation",f"simpleCancer_Meta_rho{rho}_image",
                   folder="simpleCancer_Meta")

    # plt.show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_004.png
         :alt: Lambda = 0.01 rho = 0.7
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_005.png
         :alt: source, target, Integrated source image, comparaison deformed image with target
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_006.png
         :alt: diffeo = tensor(True)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_007.png
         :alt: t = 0.0, diffeo = tensor(True), t = 0.2, diffeo = tensor(True), t = 0.4, diffeo = tensor(True), t = 0.7, diffeo = tensor(True), t = 1.0, diffeo = tensor(True)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_007.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_008.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_008.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_009.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_010.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_010.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_011.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_011.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_012.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_012.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_013.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_013.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_014.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_014.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_015.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_015.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_016.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_016.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_017.png
         :alt: toyExample weightedMetamorphosis
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_017.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Progress: [#---------]  10.00%  (Ssd : ,350.1366).    Progress: [##--------]  15.00%  (Ssd : , 91.3460).    Progress: [##--------]  20.00%  (Ssd : , 72.6602).    Progress: [##--------]  25.00%  (Ssd : , 63.5695).    Progress: [###-------]  30.00%  (Ssd : , 58.9446).    Progress: [####------]  35.00%  (Ssd : , 53.5088).    Progress: [####------]  40.00%  (Ssd : , 49.1567).    Progress: [####------]  45.00%  (Ssd : , 46.0708).    Progress: [#####-----]  50.00%  (Ssd : , 43.7511).    Progress: [######----]  55.00%  (Ssd : , 40.8513).    Progress: [######----]  60.00%  (Ssd : , 38.6410).    Progress: [######----]  65.00%  (Ssd : , 37.4236).    Progress: [#######---]  70.00%  (Ssd : , 36.5052).    Progress: [########--]  75.00%  (Ssd : , 35.0647).    Progress: [########--]  80.00%  (Ssd : , 33.3091).    Progress: [########--]  85.00%  (Ssd : , 32.4722).    Progress: [#########-]  90.00%  (Ssd : , 31.8397).    Progress: [##########]  95.00%  (Ssd : , 30.9987).    Progress: [##########] 100.00% Done...
     (Ssd : , 30.7090).
    Computation of forward done in  0:01:18s and 0.538cents  s

    Computation of metamorphosis done in  0:01:18s and 0.539cents  s
    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.1042790487408638..1.2210246324539185].
    convert -delay 40 -loop 0 /home/runner/work/Demeter_metamorphosis/Demeter_metamorphosis/examples/gifs/simpleCancer_Meta/simpleCancer_Meta_rho0.7_image_\d3.png /home/runner/work/Demeter_metamorphosis/Demeter_metamorphosis/examples/gifs/simpleCancer_Meta/simpleCancer_Meta_rho0.7_image.gif
            Cleaning saved files.
    Your gif was successfully saved at : /home/runner/work/Demeter_metamorphosis/Demeter_metamorphosis/examples/gifs/simpleCancer_Meta/simpleCancer_Meta_rho0.7_image.gif 

    ('/home/runner/work/Demeter_metamorphosis/Demeter_metamorphosis/examples/gifs/simpleCancer_Meta/', 'simpleCancer_Meta_rho0.7_image.gif')



.. GENERATED FROM PYTHON SOURCE LINES 109-114

####################################################################
  Weighted metamorphosis with time constant mask.
 # =============================================================================
 inverse the mask to have M(x) = 0 where we want to add
 intensity.

.. GENERATED FROM PYTHON SOURCE LINES 114-136

.. code-block:: Python


    print("\n\nComputing weighted metamorphosis - time constant mask")
    print("="* 20)

    cst_mask = 1 - seg.repeat(10,1,1,1) * .5
    lamb= .0001
    n_iter,grad_coef = (20,.1)
    momentum_ini = 0
    mr_wm = mt.weighted_metamorphosis(source,target,momentum_ini,cst_mask,
                        kernelOperator=kernelOp,
                        cost_cst=lamb,
                        n_iter=n_iter,
                        grad_coef=grad_coef,
                        safe_mode=False,
                        dx_convention='pixel',
                        optimizer_method='LBFGS_torch'
    )

    mr_wm.plot()
    mr_wm.plot_deform()
    plt.show()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_018.png
         :alt: Lambda = 0.0001
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_018.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_019.png
         :alt: source, target, Integrated source image, comparaison deformed image with target
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_019.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_020.png
         :alt: diffeo = tensor(True)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_020.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none



    Computing weighted metamorphosis - time constant mask
    ====================
    plop
    not oriented
    Weighted
    Progress: [#---------]  10.00%  (Ssd : ,390.9550).    Progress: [##--------]  15.00%  (Ssd : ,141.4998).    Progress: [##--------]  20.00%  (Ssd : ,106.5434).    Progress: [##--------]  25.00%  (Ssd : , 89.9974).    Progress: [###-------]  30.00%  (Ssd : , 78.1236).    Progress: [####------]  35.00%  (Ssd : , 68.8127).    Progress: [####------]  40.00%  (Ssd : , 60.8570).    Progress: [####------]  45.00%  (Ssd : , 55.0437).    Progress: [#####-----]  50.00%  (Ssd : , 50.4887).    Progress: [######----]  55.00%  (Ssd : , 47.9175).    Progress: [######----]  60.00%  (Ssd : , 46.8294).    Progress: [######----]  65.00%  (Ssd : , 45.5413).    Progress: [#######---]  70.00%  (Ssd : , 44.5117).    Progress: [########--]  75.00%  (Ssd : , 43.9820).    Progress: [########--]  80.00%  (Ssd : , 43.4689).    Progress: [########--]  85.00%  (Ssd : , 43.0661).    Progress: [#########-]  90.00%  (Ssd : , 42.5815).    Progress: [##########]  95.00%  (Ssd : , 41.7998).    Progress: [##########] 100.00% Done...
     (Ssd : , 40.5602).
    Computation of forward done in  0:01:39s and 0.404cents  s

    Computation of weighted_metamorphosis done in  0:01:39s and 0.404cents  s
    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [0.0..1.1221727132797241].




.. GENERATED FROM PYTHON SOURCE LINES 137-141

Weighted metamorphosis with time evolving mask.
=============================================================================

Mask making

.. GENERATED FROM PYTHON SOURCE LINES 141-172

.. code-block:: Python

    print("\n\n Weighted metamorphosis - evolving mask")
    print("="* 20)
    print("\tComputing evolving mask")

    residuals = 0
    # sigma = [8,10]

    mr = mt.lddmm(ini_ball,seg,residuals,kernelOp,.0001,
                        integration_steps=15,n_iter=10,grad_coef=1,
                        safe_mode=False,
                      dx_convention='pixel',
                  optimizer_method='LBFGS_torch'
                  )
    mr.plot()
    mr.plot_deform()
    mr.mp.plot()
    plt.show()
    mask = mr.mp.image_stock  # Saving the succession of images.

    mask = mr.mp.image_stock  # Saving the succession of images.
    # %matplotlib qt
    mask = 1 - .5*mask

    L = [0,2,8,-1]
    fig,ax = plt.subplots(1,len(L),figsize=(len(L)*5,10),constrained_layout=True)
    ax[0].set_title('orienting mask')
    ax[0].set_title('residuals mask')
    for i,ll in enumerate(L):
        ax[i].imshow(mask[ll,0].cpu(),cmap='gray',vmin=0, vmax = 1,origin = "lower")

    plt.show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_021.png
         :alt: Lambda = 0.0001 rho = 1.0
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_021.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_022.png
         :alt: source, target, Integrated source image, comparaison deformed image with target
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_022.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_023.png
         :alt: diffeo = tensor(True)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_023.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_024.png
         :alt: t = 0.0, diffeo = tensor(True), t = 0.2, diffeo = tensor(True), t = 0.5, diffeo = tensor(True), t = 0.7, diffeo = tensor(True), t = 1.0, diffeo = tensor(True)
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_024.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_025.png
         :alt: residuals mask
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_025.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none



     Weighted metamorphosis - evolving mask
    ====================
            Computing evolving mask
    Progress: [##--------]  20.00%  (Ssd : , 44.2237).    Progress: [###-------]  30.00%  (Ssd : , 23.4098).    Progress: [####------]  40.00%  (Ssd : , 22.4012).    Progress: [#####-----]  50.00%  (Ssd : , 21.7866).    Progress: [######----]  60.00%  (Ssd : , 21.2686).    Progress: [#######---]  70.00%  (Ssd : , 20.7728).    Progress: [########--]  80.00%  (Ssd : , 20.2475).    Progress: [#########-]  90.00%  (Ssd : , 19.9452).    Progress: [##########] 100.00% Done...
     (Ssd : , 19.3586).
    Computation of forward done in  0:00:28s and 0.913cents  s

    Computation of lddmm done in  0:00:28s and 0.914cents  s




.. GENERATED FROM PYTHON SOURCE LINES 173-174

####################################################################

.. GENERATED FROM PYTHON SOURCE LINES 176-196

.. code-block:: Python


    print("\n\tComputing weighted metamorphosis")
    n_iter= 15
    grad_coef = 1
    cost_cst= .0001
    residuals = 0
    mask = mask.to(device)
    # residuals = mr_wm.to_analyse[0].clone().to(device)
    mr_wm = mt.weighted_metamorphosis(source,target,residuals,mask,
                        kernelOp,cost_cst,
                        n_iter,grad_coef,
                        safe_mode=False,
                        dx_convention='pixel',
                        optimizer_method='LBFGS_torch'
                        # optimizer_method='adadelta'
                                      )


    mr_wm.plot()
    plt.show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_026.png
         :alt: Lambda = 0.0001
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_026.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_027.png
         :alt: source, target, Integrated source image, comparaison deformed image with target
         :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_027.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


            Computing weighted metamorphosis
    plop
    not oriented
    Weighted
    Progress: [#---------]  13.33%  (Ssd : ,399.7340).    Progress: [##--------]  20.00%  (Ssd : ,161.5565).    Progress: [###-------]  26.67%  (Ssd : ,125.7210).    Progress: [###-------]  33.33%  (Ssd : ,104.8609).    Progress: [####------]  40.00%  (Ssd : , 87.5565).    Progress: [#####-----]  46.67%  (Ssd : , 73.6878).    Progress: [#####-----]  53.33%  (Ssd : , 65.4743).    Progress: [######----]  60.00%  (Ssd : , 61.6891).    Progress: [#######---]  66.67%  (Ssd : , 58.5389).    Progress: [#######---]  73.33%  (Ssd : , 56.3414).    Progress: [########--]  80.00%  (Ssd : , 54.9665).    Progress: [#########-]  86.67%  (Ssd : , 53.3864).    Progress: [#########-]  93.33%  (Ssd : , 51.5325).    Progress: [##########] 100.00% Done...
     (Ssd : , 50.2708).
    Computation of forward done in  0:01:03s and 0.523cents  s

    Computation of weighted_metamorphosis done in  0:01:03s and 0.523cents  s
    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [0.0..1.1337158679962158].




.. GENERATED FROM PYTHON SOURCE LINES 197-199

.. code-block:: Python

    mr_wm.plot_deform()
    plt.show()



.. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_028.png
   :alt: diffeo = tensor(True)
   :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_028.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 200-204

.. code-block:: Python


    mr_wm.mp.plot()
    plt.show()




.. image-sg:: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_029.png
   :alt: t = 0.0, diffeo = tensor(True), t = 0.2, diffeo = tensor(True), t = 0.5, diffeo = tensor(True), t = 0.7, diffeo = tensor(True), t = 1.0, diffeo = tensor(True)
   :srcset: /auto_examples/1_registration/images/sphx_glr_toyExample_weightedMetamorphosis_029.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (4 minutes 51.643 seconds)


.. _sphx_glr_download_auto_examples_1_registration_toyExample_weightedMetamorphosis.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: toyExample_weightedMetamorphosis.ipynb <toyExample_weightedMetamorphosis.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: toyExample_weightedMetamorphosis.py <toyExample_weightedMetamorphosis.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: toyExample_weightedMetamorphosis.zip <toyExample_weightedMetamorphosis.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
